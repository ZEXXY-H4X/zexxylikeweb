<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZEXXY Like Panel</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="welcome-card" id="welcomeCard">Welcome to ZEXXY Like Panel!</div>
<div class="wrapper">
  <div>
    <div class="hero panel">
      <img src="avatar.jpg" alt="avatar" class="avatar" />
      <div class="title">
        <h1 style="margin-bottom:4px">🔥 ZEXXY Like</h1>
        <div class="subtitle">Free Fire Likes • Fast • Live</div>
      </div>
      <a class="owner-link" href="https://t.me/ZEXXY_H4X" target="_blank">👑 @ZEXXY_H4X</a>
    </div>

    <div class="panel">
      <div class="form-row">
        <input id="uid" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="Enter UID (e.g. 123456789)" />
        <select id="region">
          <option value="india">India</option>
          <option value="bd">Bangladesh</option>
          <option value="us">USA</option>
        </select>
        <button id="sendBtn" class="btn" onclick="sendLikes()">🚀 Send Likes</button>
      </div>
      <div class="status-line">Status: <span id="statusText">Ready</span></div>
      <div id="output" class="result" aria-live="polite">
        <div class="row"><div class="label">Info</div><div class="value muted">No request yet.</div></div>
      </div>
      <div id="feedback"></div>
      <pre id="rawJson" class="json" style="display:none"></pre>
    </div>
  </div>

  <div class="side">
    <div class="total-box panel">
      <div class="num" id="totalLikes">0</div>
      <div class="cap">Total Likes Sent</div>
    </div>
  </div>
</div>

<script>
const API_BASE = '/api/like';
let totalLikesSent = 0;
const totalLikesEl = document.getElementById('totalLikes');
const rawJsonEl = document.getElementById('rawJson');
const outputEl = document.getElementById('output');
const statusText = document.getElementById('statusText');
const feedbackEl = document.getElementById('feedback');

function escapeHtml(s){if(s===null||s===undefined)return "";return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));}

document.addEventListener('DOMContentLoaded',()=>{setTimeout(()=>{document.getElementById('welcomeCard').style.opacity=1;},200);});

async function sendLikes(){
  const uid=document.getElementById('uid').value.trim();
  const region=document.getElementById('region').value;
  feedbackEl.innerHTML='';
  if(!uid){outputEl.innerHTML='⚠️ Please enter UID';return;}
  statusText.innerText='Processing...';
  outputEl.innerHTML='⏳ Sending request...';

  try{
    const resp=await fetch(`${API_BASE}?uid=${encodeURIComponent(uid)}&region=${encodeURIComponent(region)}`);
    const data=await resp.json();
    rawJsonEl.textContent = JSON.stringify(data,null,2);

    if(!data||typeof data!=='object'){outputEl.innerHTML='⚠️ Invalid API response';statusText.innerText='Error';return;}

    const nickname=data.PlayerNickname??`Player_${uid}`;
    const returnedUID=data.UID??uid;
    const likesBefore=data.LikesbeforeCommand??'-';
    const likesAfter=data.LikesafterCommand??'-';
    const likesGiven=data.LikesGivenByAPI??0;

    let html='';
    html+=`👤 Name: ${escapeHtml(nickname)}<br>`;
    html+=`🆔 UID: ${escapeHtml(returnedUID)}<br>`;
    html+=`🌍 Server: ${escapeHtml(region.toUpperCase())}<br>`;
    html+=`😭 Before: ${escapeHtml(likesBefore)}<br>`;
    html+=`☠️ After: ${escapeHtml(likesAfter)}<br>`;
    html+=`😊 Likes Given: ${escapeHtml(likesGiven)}<br>`;
    outputEl.innerHTML = html;

    if(likesGiven===0){feedbackEl.innerHTML='<div class="alert warn">UID have received max like today</div>';}
    else{totalLikesSent+=likesGiven; totalLikesEl.innerText=totalLikesSent; feedbackEl.innerHTML=`<div class="alert success">+${likesGiven} likes added</div>`;}

    statusText.innerText='Success';
  }catch(err){
    console.error(err);
    outputEl.innerHTML='🚨 API Error: '+escapeHtml(err.message);
    statusText.innerText='API Error';
  }
}
</script>
</body>
</html>