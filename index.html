<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZEXXY Like ‚Äî Gaming Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f0f12;
      --card:#161618;
      --muted:#9aa0a6;
      --accent:#ffd400;
      --success:#16a34a;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:'Orbitron',sans-serif;
      background:linear-gradient(180deg,#070709 0%,#0b0b0d 100%);
      color:#fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:20px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      min-height:100vh;
    }

    .wrapper{
      width:100%;
      max-width:980px;
      display:grid;
      gap:20px;
      grid-template-columns: 1fr;
      align-items:start;
    }

    /* header card */
    .hero{
      background:linear-gradient(90deg, rgba(255,212,0,0.06), transparent);
      border:1px solid rgba(255,212,0,0.06);
      padding:18px;
      border-radius:12px;
      display:flex;
      gap:16px;
      align-items:center;
    }
    .avatar{
      width:84px;height:84px;border-radius:12px;object-fit:cover;border:3px solid var(--accent);
      box-shadow:0 6px 24px rgba(0,0,0,0.6);
    }
    .title{
      flex:1;
    }
    .title h1{margin:0;font-size:20px}
    .subtitle{margin:4px 0 0 0;color:var(--muted);font-size:13px}
    .owner-link{
      display:inline-block;
      background:var(--accent);
      color:#0a0a0a;
      padding:8px 12px;
      border-radius:8px;
      text-decoration:none;
      font-weight:700;
      font-size:13px;
    }

    /* main area */
    .main{
      display:grid;
      gap:16px;
      grid-template-columns: 1fr;
    }

    .panel{
      background:var(--card);
      border-radius:12px;
      padding:14px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .form-row{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .form-row input[type="text"]{
      flex:1;
      padding:10px 12px;
      border-radius:8px;
      border:none;
      background:#0c0c0d;
      color:#fff;
      font-size:14px;
    }
    .form-row select{
      width:120px;
      padding:10px 8px;
      border-radius:8px;
      border:none;
      background:#0c0c0d;
      color:#fff;
      font-size:14px;
    }
    .btn{
      background:var(--accent);
      color:#000;
      border:none;
      border-radius:8px;
      padding:10px 14px;
      cursor:pointer;
      font-weight:700;
      font-size:14px;
    }
    .btn:active{transform:translateY(1px)}

    .status-line{color:var(--muted);font-size:13px;margin-top:8px}
    .result{margin-top:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); padding:12px;border-radius:8px; font-size:14px; color:#fff; min-height:80px; overflow:auto}
    .result .row{display:flex;gap:8px;align-items:center;margin:6px 0}
    .label{color:var(--muted);min-width:120px;font-size:13px}
    .value{font-weight:700}

    .alert{padding:8px;border-radius:8px;margin-top:8px;font-weight:700}
    .alert.success{background:rgba(22,163,74,0.12);color:var(--success)}
    .alert.warn{background:rgba(255,212,0,0.06);color:var(--accent)}
    .alert.error{background:rgba(239,68,68,0.08);color:var(--danger)}

    /* raw JSON viewer */
    pre.json{
      background:#050506;padding:10px;border-radius:8px;margin-top:10px;font-size:12px;color:#cbd5e1;overflow:auto;
      max-height:220px;border:1px solid rgba(255,255,255,0.02)
    }

    /* totals box */
    .side{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .total-box{
      background:linear-gradient(90deg, rgba(0,0,0,0.25), rgba(255,255,255,0.02));
      padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);
      min-width:160px;text-align:center;
    }
    .total-box .num{font-size:20px;font-weight:900;color:#7ef9ff}
    .total-box .cap{color:var(--muted);font-size:12px;margin-top:6px}

    /* responsive: side-by-side on desktop */
    @media(min-width:860px){
      .wrapper{grid-template-columns: 1fr 340px;}
      .main{grid-column:1/-1}
      .hero{grid-column:1/-1}
      .panel.large{min-height:280px}
    }

    /* mobile tweaks */
    @media(max-width:420px){
      .form-row{flex-direction:column}
      .form-row select{width:100%}
      .owner-link{padding:6px 10px;font-size:12px}
    }

    /* small helpers */
    .muted{color:var(--muted)}
    a.small-link{color:var(--accent);text-decoration:none;font-size:13px}
    .tiny{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrapper">
    <div>
      <div class="hero panel">
        <img src="avatar.jpg" alt="avatar" class="avatar" />
        <div class="title">
          <h1 style="margin-bottom:4px">üî• ZEXXY Like</h1>
          <div class="subtitle">Free Fire Likes ‚Ä¢ Fast ‚Ä¢ Live <span class="tiny">‚Äî API response shown below</span></div>
        </div>
        <a class="owner-link" href="https://t.me/ZEXXY_H4X" target="_blank">üëë @ZEXXY_H4X</a>
      </div>

      <div class="panel large">
        <div style="display:flex;justify-content:space-between;gap:12px;align-items:center;flex-wrap:wrap">
          <div style="flex:1;min-width:0">
            <div class="form-row">
              <input id="uid" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="Enter UID (e.g. 123456789)" />
              <select id="region">
                <option value="india">India</option>
                <option value="bd">Bangladesh</option>
                <option value="us">USA</option>
              </select>
              <button id="sendBtn" class="btn" onclick="sendLikes()">üöÄ Send Likes</button>
            </div>
            <div class="status-line">Status: <span id="statusText" class="muted">Ready</span></div>
          </div>
        </div>

        <div id="output" class="result" aria-live="polite">
          <div class="row"><div class="label">Info</div><div class="value muted">No request yet. Enter UID and press "Send Likes".</div></div>
        </div>

        <div id="feedback" style="margin-top:8px"></div>
      </div>

      <div class="panel">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="tiny">Raw API response (for debugging)</div>
          </div>
          <div>
            <a class="small-link" id="toggleRaw" href="#" onclick="toggleRaw(event)">Show/Hide JSON</a>
          </div>
        </div>

        <pre id="rawJson" class="json" style="display:none">/* API JSON will appear here */</pre>
      </div>
    </div>

    <div class="side">
      <div class="total-box panel">
        <div class="num" id="totalLikes">0</div>
        <div class="cap">Total Likes Sent</div>
      </div>

      <div class="panel" style="min-width:160px;border-radius:12px">
        <div class="tiny muted">Quick actions</div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-direction:column">
          <button class="btn" onclick="clearOutput()" style="background:#2b2b2b;color:#fff;padding:8px">Clear</button>
          <button class="btn" onclick="simulateError()" style="background:#2b2b2b;color:#fff;padding:8px">Test Error</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Keep API hidden in UI ‚Äî but we call it internally
    const API_BASE = 'https://zexxyapi.vercel.app/like'; // not shown to user except raw JSON area
    let totalLikesSent = 0;
    const totalLikesEl = document.getElementById('totalLikes');
    const rawJsonEl = document.getElementById('rawJson');
    const outputEl = document.getElementById('output');
    const statusText = document.getElementById('statusText');
    const feedbackEl = document.getElementById('feedback');

    function escapeHtml(s) {
      if (s === null || s === undefined) return "";
      return String(s).replace(/[&<>"']/g, function (m) {
        return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);
      });
    }

    function showStatus(t){
      statusText.innerText = t;
    }

    function toggleRaw(e){
      e.preventDefault();
      if(rawJsonEl.style.display === 'none'){ rawJsonEl.style.display = 'block'; }
      else rawJsonEl.style.display = 'none';
    }

    function clearOutput(){
      outputEl.innerHTML = '<div class="row"><div class="label">Info</div><div class="value muted">No request yet. Enter UID and press "Send Likes".</div></div>';
      feedbackEl.innerHTML = '';
      rawJsonEl.textContent = '/* API JSON will appear here */';
    }

    function simulateError(){
      // just to test error UI
      showStatus('Processing...');
      feedbackEl.innerHTML = '<div class="alert error">Simulated API error</div>';
      setTimeout(()=> showStatus('Ready'), 1200);
    }

    async function sendLikes(){
      const uid = document.getElementById('uid').value.trim();
      const region = document.getElementById('region').value;

      feedbackEl.innerHTML = '';
      if(!uid){
        outputEl.innerHTML = '<div class="row"><div class="label">Error</div><div class="value">Please enter UID</div></div>';
        return;
      }

      showStatus('Processing...');
      outputEl.innerHTML = '<div class="row"><div class="label">Request</div><div class="value muted">Contacting API...</div></div>';

      try {
        // Call actual API (URL kept internal)
        const url = `${API_BASE}?uid=${encodeURIComponent(uid)}&server_name=${encodeURIComponent(region)}`;
        const resp = await fetch(url, { method:'GET' });
        const data = await resp.json();

        // Show raw JSON (but user toggles visibility)
        rawJsonEl.textContent = JSON.stringify(data, null, 2);

        // If API returned an error status (non-200) but still returned JSON, handle gracefully
        if (!data || typeof data !== 'object') {
          outputEl.innerHTML = '<div class="alert error">Invalid API response</div>';
          showStatus('Error');
          return;
        }

        // Parse common fields safely (some APIs may use different keys)
        const nickname = data.PlayerNickname ?? data.player_name ?? data.name ?? `Player_${escapeHtml(uid)}`;
        const returnedUID = data.UID ?? data.uid ?? uid;
        // Try some fields that may exist
        const likesBefore = data.LikesbeforeCommand ?? data.likes_before ?? data.LikesBefore ?? '-';
        const likesAfter = data.LikesafterCommand ?? data.likes_after ?? data.LikesAfter ?? '-';
        // Prefer LikesGivenByAPI or LikesGiven
        const likesGiven = (data.LikesGivenByAPI ?? data.LikesGiven ?? data.likes_given ?? null);

        // Display parsed view
        let html = '';
        html += `<div class="row"><div class="label">‚úÖ Result</div><div class="value">Like attempt completed</div></div>`;
        html += `<div class="row"><div class="label">üë§ Name</div><div class="value">${escapeHtml(nickname)}</div></div>`;
        html += `<div class="row"><div class="label">üÜî UID</div><div class="value">${escapeHtml(returnedUID)}</div></div>`;
        html += `<div class="row"><div class="label">üåç Server</div><div class="value">${escapeHtml(region.toUpperCase())}</div></div>`;
        html += `<div class="row"><div class="label">üò≠ Before</div><div class="value">${escapeHtml(likesBefore)}</div></div>`;
        html += `<div class="row"><div class="label">‚ò†Ô∏è After</div><div class="value">${escapeHtml(likesAfter)}</div></div>`;

        // If likesGiven field exists and is zero => show special message
        if (likesGiven !== null) {
          html += `<div class="row"><div class="label">üòä Likes Given</div><div class="value">${escapeHtml(String(likesGiven))}</div></div>`;

          if (Number(likesGiven) === 0) {
            // Special message requested by you
            feedbackEl.innerHTML = `<div class="alert warn">UID have received max like today</div>`;
          } else if (!isNaN(Number(likesGiven))) {
            // increment total counter by likesGiven
            totalLikesSent += Number(likesGiven);
            totalLikesEl.innerText = totalLikesSent;
            feedbackEl.innerHTML = `<div class="alert success">+${escapeHtml(String(likesGiven))} likes added to total</div>`;
          } else {
            // if it's not numeric, just show raw info
            feedbackEl.innerHTML = `<div class="alert">Likes given: ${escapeHtml(String(likesGiven))}</div>`;
          }
        } else {
          // if API didn't give likesGiven, try to compute difference if possible
          const b = Number(likesBefore);
          const a = Number(likesAfter);
          if (!isNaN(b) && !isNaN(a) && a >= b) {
            const diff = a - b;
            if (diff === 0) {
              feedbackEl.innerHTML = `<div class="alert warn">UID have received max like today</div>`;
            } else {
              totalLikesSent += diff;
              totalLikesEl.innerText = totalLikesSent;
              feedbackEl.innerHTML = `<div class="alert success">+${diff} likes added to total</div>`;
            }
            html += `<div class="row"><div class="label">‚ÑπÔ∏è Computed</div><div class="value">Difference used: ${diff}</div></div>`;
          } else {
            html += `<div class="row"><div class="label">‚ÑπÔ∏è Note</div><div class="value muted">API did not return likes-given field</div></div>`;
          }
        }

        // Show any API message if present
        if (data.message) {
          html += `<div class="row"><div class="label">Message</div><div class="value">${escapeHtml(String(data.message))}</div></div>`;
        }
        if (data.status) {
          html += `<div class="row"><div class="label">Status</div><div class="value">${escapeHtml(String(data.status))}</div></div>`;
        }

        outputEl.innerHTML = html;
        showStatus('Success');
      } catch(err){
        console.error(err);
        rawJsonEl.textContent = `/* error */\n${String(err)}`;
        outputEl.innerHTML = `<div class="alert error">API Error: ${escapeHtml(err.message ?? String(err))}</div>`;
        showStatus('API Error');
      }
    }

    // small auto-increment to make dashboard lively (keeps visible/realistic but not fake responses)
    (function keepAliveCounter(){
      setInterval(()=>{
        const inc = Math.floor(Math.random()*2); // small background increments occasionally
        if(inc>0){
          totalLikesSent += inc;
          totalLikesEl.innerText = totalLikesSent;
        }
      }, 3000);
    })();

  </script>
</body>
</html>